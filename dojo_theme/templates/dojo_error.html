{% extends "base.html" %}
{% from "macros/widgets.html" import module_icon %}
{% from "macros/widgets.html" import card %}

{% block content %}
<div class="jumbotron">
</div>
<div class="container">

    <h2 class="row">请训练家前往先前的道馆提升实力之后再来吧！</h2>
  <div class="row">
  <img src="/themes/dojo_theme/static/img/dojo/deteat.png" style="width: 500px;">

  </div>
  <div class="row text-center">
    {% if dojo.course and user %}
    <div class="col-lg-auto m-3">
      <figure>
        <a class="text-decoration-none">
          <i class="fas fa-graduation-cap fa-3x"></i>
          <figcaption><b style="font-family: 'Courier New', Courier, monospace">课程</b></figcaption>
        </a>
      </figure>
    </div>
    {% endif %}

  </div>
  <h2 class="row">神奇宝贝道馆</h2>
  <ul class="card-list">
    {{ card(url_for("pwncollege_dojos.view_dojo", dojo=dojo.reference_id),
    title=dojo.name or dojo.id,
    text="{} Modules : ".format(dojo.modules | length) + "{} / {}".format(dojo.solves(user=user, ignore_visibility=True, ignore_admins=False).count() if user else 0, dojo.challenges | length),
    icon="/themes/dojo_theme/static/img/dojo/{}.svg".format(dojo.award.emoji) if (dojo.award.emoji and dojo.official) else None) }}
  <br>
    </ul>

  <h2 class="row">道馆模块</h2>
  <br>
  <ul class="card-list">
    {% for module in dojo_locked.modules %}
    <a class="text-decoration-none">
      {# TODO: card-active, card-hidden #}
      <li class="card card-small">
        <div class="card-body">
          <h4 class="card-title">{{ module.name or module.id }}</h4>
            {% if module.data.icon %}
              {{ module_icon(icon="/themes/dojo_theme/static/img/dojo/lock_ball.png") }}  
            {% endif %}
          <p class="card-text">
            {{ module.solves(user=user, ignore_visibility=True, ignore_admins=False).count() if user else 0 }} / {{ module.visible_challenges() | length }}
          </p>
        </div>
      </li>
    </a>
    {% endfor %}

</div>
{% endblock %}

{% block scripts %}
<script defer onload="loadScoreboard(30, 1);" src="{{ url_for('views.themes', path='js/dojo/scoreboard.js') }}"></script>
<script defer src="{{ url_for('views.themes', path='js/dojo/copy.js') }}"></script>
{% endblock %}
